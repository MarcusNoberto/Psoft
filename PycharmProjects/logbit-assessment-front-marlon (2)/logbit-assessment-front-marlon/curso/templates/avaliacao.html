{% extends 'base/base.html' %}
{% load static %}

{% block extra_styles %}
{% endblock %}

{% block content %}
<main id="module" class="content">
    <div class="modulo--wrapper">
        <div>
            <header>
                <h2 class="modulo--title">Evaluación - {{avaliacao.modulo}}</h2>
                <p class="modulo--desc">{{avaliacao.descricao|linebreaks}}</p>
            </header>
            
            <form action="{% url 'avaliacao' avaliacao.id tipo_pergunta pergunta.id %}" name="form-pergunta" method="post">
                {% csrf_token %}
                <div class="wrapper-questions">
                    {% if tipo_pergunta == 'objetiva' %}
                        <div class="modulo--question">
                            <p class="m-0">{{pergunta.titulo}}</p>
                            <span>{{pergunta.descricao}}</span>
    
                            <div class="mt-3">
                                <select required name="pergunta_objetiva" id="pergunta_objetiva">
                                    <option value="">-------</option>
                                    
                                    {% for alternativa in pergunta.alternativa_set.all %}
                                        <option value="{{alternativa.id}}">{{alternativa.titulo}}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
                    {% elif tipo_pergunta == 'discursiva' %}
                        <div class="modulo--question">
                            <p class="m-0">{{pergunta}}</p>
                            <span>{{pergunta.descricao}}</span>
    
                            <div class="mt-3">
                                <input required name="pergunta_discursiva" type="text" placeholder="Digite sua resposta aqui...">
                            </div>
                        </div>
                    {% elif tipo_pergunta == 'check' %}
                        <div class="modulo--question">
                            <p class="m-0">{{pergunta}}</p>
                            <span>{{pergunta.descricao}}</span>
    
                            <div class="mt-3 radio--form">
                                <label for="pergunta_check-yes">
                                    <input type="radio" name="pergunta_check" value="SIM" id="pergunta_check-yes">
                                    <span>Sí</span>
                                </label>

                                <label for="pergunta_check-no">
                                    <input type="radio" name="pergunta_check" value="NAO" id="pergunta_check-no">
                                    <span>No</span>
                                </label>
                            </div>
                        </div>
                    {% endif %}
                </div>
            </form>
        </div>

        <button onclick="document.forms['form-pergunta'].submit()" class="modulo--button">Continuar</button>
    </div>

    <div class="video--list">
        <div class="list--title">
            <svg>
                <use xlink:href="#icon_list"></use>
            </svg>

            <h2>Mas clases</h2>
        </div>

        <div class="list--itens">
            {% for video in avaliacao.modulo.video_set.all %}
            <a href="{% url 'video:video' avaliacao.modulo.id video.id %}?curso={{curso.id}}">
                <div class="list--item">
                    {% if video.thumbnail %}
                        <div class="video">
                            <img src="{{video.thumbnail.url}}" class="background">
                            <img src="{% static 'assessment/assets/img/play-icon.png' %}" class="icon">
                        </div>
                    {% else %}
                        <div class="video">
                            <img src="{% static 'assessment/assets/dist/images/video_padrao.png' %}" class="background">
                            <img src="{% static 'assessment/assets/img/play-icon.png' %}" class="icon">
                        </div>
                    {% endif %}
                    <div class="video-desc">
                        <div class="d-flex">
                            <span>{{video.titulo}}</span>
                            {% if user in video.usuarios_concluintes.all %}
                                <svg>
                                    <use xlink:href="#icon_certo"></use>
                                </svg>
                            {% endif %}
                        </div>

                        <p>{{video.descricao|linebreaks}}</p>
                    </div>
                </div>
            </a>
            {% endfor %}
        </div>
    </div>
</main>
{% endblock %}

{% block extra_js %}
    <script type="module">
        import initChoices from "{% static './assessment/assets/js/modules/initChoices.js' %}"

        // Select choices
        const questionSelectEl = document.querySelector('#pergunta_objetiva')
        initChoices(questionSelectEl)
    </script>    
{% endblock %}